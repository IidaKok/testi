trigger:
- main

pool:
  name: Azure Pipelines
  demands: npm

steps:
- task: Npm@1
  displayName: 'npm install'
  inputs:
    verbose: false

- task: Npm@1
  displayName: 'npm build'
  inputs:
    command: custom
    verbose: false
    customCommand: 'run build'

- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: drop'
  inputs:
    PathtoPublish: build

- script: |
    git config --global user.email iida.kokkonen@edu.savonia.fi
    git config --global user.name iidakok
    git clone https://github.com/iidakok/testi
    cd build
    git checkout gh-pages
    cp -R ../$(Build.ArtifactStagingDirectory)/* ./
    git add .
    git commit -m 'Update gh-pages'
    git push origin gh-pages
  displayName: 'Deploy to gh-pages'
